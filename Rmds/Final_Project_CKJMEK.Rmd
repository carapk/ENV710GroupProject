---
title: "ENV 710 Final Project"
author: "Emma Kaufman, Cara Kuuskvere, Jenn McNeill"
date: "2024-04-10"
output: pdf_document
editor_options: 
  chunk_output_type: console
toc: true
---

```{r load packages, include=FALSE, message=FALSE, warning=FALSE}

library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(tidyverse)
library(lubridate)
library(latex2exp)
library(lubridate)
library(lme4)

```

```{r import and wrangle data, include=FALSE, message=FALSE, warning=FALSE}

lakes_raw <- read.csv("./Data/Raw/NTL-LTER_Lake_Nutrients_Raw.csv",stringsAsFactors = TRUE) 
do_raw <- read.csv("Data/Raw/NTL-LTER_Lake_ChemistryPhysics_Raw.csv",stringsAsFactors = TRUE)

lakes_raw$sampledate <- mdy(lakes_raw$sampledate)
do_raw$sampledate <- mdy(do_raw$sampledate)

lakes_processed <- lakes_raw %>%
  select(lakename, sampledate, depth, tn_ug, tp_ug, nh34, no23, po4) %>%
  na.omit() %>%
  filter(lakename %in% c("Paul Lake", "West Long Lake", "Peter Lake", "East Long Lake")) %>%
  #filter(year(sampledate) >= 1994 & year(sampledate) <= 1999) %>%
  mutate(year = factor(year(sampledate)),
         month = factor(month(sampledate)),
         subsurface = factor(ifelse(depth > 6, "subsurface", "surface")),
         season = factor(ifelse(month == 5, "spring", ifelse(month == 8, "summer", NA)))) %>%
  filter(month %in% c(5,6,7,8)) %>%
  mutate(depth = round(depth * 2) / 2)

lakes_processed$subsurface_indicator <- 
  ifelse(lakes_processed$subsurface == "subsurface", 1, 0)

lakes_processed$summer_indicator <- 
  ifelse(lakes_processed$season == "summer", 1, 0)

lakes_processed <- left_join(lakes_processed, 
                             select(do_raw, lakename, sampledate, depth, dissolvedOxygen), 
                             by = c("lakename", "sampledate", "depth"))

lake_1994 <- lakes_processed %>% 
  filter(year %in% c(1994)) %>% 
  filter(po4<20) %>% 
  filter(tp_ug<100)

```


## MODEL FIT ONE: Dissolved Oxygen by Total Phosphorus with a Seasonal Binary Indicator Variable and a Seasonal Interaction Term

```{r seasonal model, include=FALSE, message=FALSE, warning=FALSE}

two_season_clean <- lakes_processed %>% 
  na.omit()

two_season_fit <- lm(dissolvedOxygen ~ summer_indicator + tp_ug + summer_indicator*tp_ug,
                     data = two_season_clean)

summary(two_season_fit)

```

a. What is the estimate of $\beta_0$ and what does it represent in terms of DO (dissolved oxygen)?

$\beta_0$ for this fit is 10.14 mg/L, which represents the expected value of DO in spring with zero total phosphorus.

b. What is the estimate of $\beta_1$ and what does it represent in terms of DO?

$\beta_1$ for this fit is -2.36, which represents the difference in DO between spring and summer with zero total phosphorus. In summer the expected dissolved oxygen is 8.7 mg/L. 

c. What is the estimate of $\beta_2$ and what does it represent in terms of DO?

$\beta_2$ for this fit is -0.067 (mg/L)/ug, which represents the expected change in DO for each unit increase in total phosphorus during spring.

d. What is the estimate of $\beta_3$ and what does it represent in terms of DO?

$\beta_3$ for this fit is 0.02 (mg/L)/ug, which represents the adjustment to the slope for each unit increase in total phosphorus during the summer. In the summer the expected change in DO for each unit increase in total phosphorus is -0.045 (mg/L)/ug. 

```{r seasonal model holdout and MAPE calculation, include = FALSE, message=FALSE, warning=FALSE}

# Holdout 20% of data for testing, 80% for training

two_season_clean$holdout <- rbinom(n=nrow(two_season_clean),size=1,prob=0.2)
two_season_training <- two_season_clean %>% filter(holdout==0)
two_season_testing <- two_season_clean %>% filter(holdout==1)

two_season_fit_test <- lm(dissolvedOxygen ~ summer_indicator + tp_ug + summer_indicator*tp_ug,
                          data = two_season_training)

print(two_season_fit_test)

two_season_fit_test_beta_0 <- 10.33176
two_season_fit_test_beta_1 <- -2.54724
two_season_fit_test_beta_2 <- -0.07045
two_season_fit_test_beta_3 <- 0.02518

two_season_testing$do_predicted <- two_season_fit_test_beta_0 + 
    two_season_fit_test_beta_1*two_season_testing$summer_indicator +
    two_season_fit_test_beta_2*two_season_testing$tp_ug +
    two_season_fit_test_beta_3*two_season_testing$summer_indicator*two_season_testing$tp_ug

MAPE_seasonal <- sqrt(mean((two_season_testing$dissolvedOxygen - two_season_testing$do_predicted)^2))

print(MAPE_seasonal)

```

```{r seasonal model plot, fig.cap="Figure 1", echo=FALSE, message=FALSE}

ggplot(two_season_clean, aes(x=tp_ug, y=dissolvedOxygen, color=season))+
  geom_point()+
  geom_abline(intercept = coef(two_season_fit)[1],
              slope = coef(two_season_fit)[3],
              color = "thistle3", size = 1)+
  geom_abline(intercept = coef(two_season_fit)[1] + coef(two_season_fit)[2],
              slope = coef(two_season_fit)[3] + coef(two_season_fit)[4],
              color = "darkgoldenrod1", size = 1)+
  scale_color_manual(values = c("spring" = "thistle3", "summer" = "darkgoldenrod1"))+
  scale_x_continuous(breaks = seq(0, 300, by = 50))+
  scale_y_continuous(breaks = seq(0, 15, by = 5))+
  xlab(expression("Total Phosphorus" ~ (µg)))+
  ylab("Dissolved Oxygen (mg/L)")+
  ggtitle("Dissolved Oxygen vs Total Phosphorus by Season")+
  theme_light()+
  theme(legend.position="right")+
  labs(color = "Season")

```

```{r seasonal model residuals, include = FALSE, message=FALSE, warning=FALSE}

plot(two_season_fit)

```
**discuss the poor model fit in results and talk about how we attempted to log transform the x axis and tried to use a subset of the y axis dissolved oxygen, but we still didn't see normal distribution of residuals or constant variance of residuals. reference the plots but include them in the appendix.

## MODEL FIT TWO: Dissolved Oxygen by Total Phosphorus with a Water Depth Binary Indicator Variable and a Water Depth Interaction Term

```{r depth model, include = FALSE, message=FALSE, warning=FALSE}

jenn <- lakes_processed

jenn$subsurface_tp_ug = jenn$tp_ug * jenn$subsurface_indicator
jenn$subsurface_tn_ug = jenn$tn_ug * jenn$subsurface_indicator

jenn_fit_p <- lm(formula = dissolvedOxygen ~ subsurface_indicator + tp_ug + subsurface_tp_ug, 
                 data = jenn)

print(jenn_fit_p)

```

a. What is the estimate of $\beta_0$ and what does it represent in terms of DO?

$\beta_0$ for this fit is 8.52 mg/L, which represents the expected value of DO in surface water with zero total phosphorus.

b. What is the estimate of $\beta_1$ and what does it represent in terms of DO?

$\beta_1$ for this fit is -7.67 mg/L, which represents the difference in DO between surface water and subsurface water with zero total phosphorus.

c. What is the estimate of $\beta_2$ and what does it represent in terms of DO?

$\beta_2$ for this fit is -0.0002 (mg/L)/ug, which represents the expected change in DO for each unit increase in total phosphorus in surface water.

d. What is the estimate of $\beta_3$ and what does it represent in terms of DO?

$\beta_3$ for this fit is -0.003 (mg/L)/ug, which represents the adjustment to the slope for each unit increase in total phosphorus in subsurface water.

```{r depth model holdout and MAPE calculation, include = FALSE, message=FALSE, warning=FALSE}

# Holdout 20% of data for testing, 80% for training

jenn$holdout <- rbinom(n=nrow(jenn),size=1,prob=0.2)
jenn_training <- jenn %>% filter(holdout==0)

jenn_testing <- jenn %>% filter(holdout==1)

jenn_fit_p_test <- lm(formula = dissolvedOxygen ~ subsurface_indicator + tp_ug + subsurface_tp_ug, data = jenn_training)

print(jenn_fit_p_test)

jenn_fit_p_test_beta_0 <- 8.531495
jenn_fit_p_test_beta_1 <- -7.680194
jenn_fit_p_test_beta_2 <- 0.001925
jenn_fit_p_test_beta_3 <- -0.005985

jenn_testing$do_predicted <- jenn_fit_p_test_beta_0 + 
    jenn_fit_p_test_beta_1*jenn_testing$subsurface_indicator +
    jenn_fit_p_test_beta_2*jenn_testing$tp_ug +
    jenn_fit_p_test_beta_3*jenn_testing$subsurface_tp_ug

MAPE_depth <- sqrt(mean((jenn_testing$dissolvedOxygen - jenn_testing$do_predicted)^2, na.rm = TRUE))

print(MAPE_depth)

```

```{r depth plot, fig.cap = "Figure 2", echo=FALSE, message=FALSE}

#plot total phosphorus versus dissolved oxygen
ggplot(jenn, aes(x=tp_ug, y=dissolvedOxygen, color=subsurface))+
  geom_point()+
  geom_abline(intercept = coef(jenn_fit_p)[1], 
              slope = coef(jenn_fit_p)[3], 
              color = "steelblue1", size = 1)+
  geom_abline(intercept = coef(jenn_fit_p)[1] + coef(jenn_fit_p)[2], 
              slope = coef(jenn_fit_p)[3] + coef(jenn_fit_p)[4], 
              color = "steelblue4", size = 1)+
  scale_color_manual(values = c("surface" = "steelblue1", "subsurface" = "steelblue4"))+
  scale_x_continuous(breaks = seq(0, 300, by = 50))+
  scale_y_continuous(breaks = seq(0, 15, by = 5))+
  xlab(expression("Total Phosphorus" ~ (µg)))+
  ylab("Dissolved Oxygen (mg/L)")+
  ggtitle("Dissolved Oxygen vs Total Phosphorus by Water Depth")+
  theme_light()+
  theme(legend.position="right")+
  labs(color = "depth")

```

```{r depth model residuals, include = FALSE, message=FALSE, warning=FALSE}

plot(jenn_fit_p)

```

## MODEL FIT THREE: Dissolved Oxygen by Total Phosphorus with a Hierarchical Linear Mixed Effects Lake Variable

```{r hierarchical model, include = FALSE, message=FALSE, warning=FALSE}

# Fit hierarchical linear mixed-effects model
fit <- lmer(dissolvedOxygen ~ tp_ug + (1|lakename), data = lakes_processed)

# Summary of the model
summary(fit)

# Print the model
print(fit)

# Extract the random effects
random_effects <- fit@u

```

a. $\beta_0$ (Intercept): 8.68 mg/L

This represents the expected value of dissolved oxygen in surface water with zero total phosphorus.

b. $\beta_1$ (tp_ug): -0.055 mg/L

This represents the change in dissolved oxygen for each unit increase in total phosphorus in surface water.

```{r hierarchical model holdout and MAPE calculation, include = FALSE, message=FALSE, warning=FALSE}

# Holdout 20% of data for testing, 80% for training
lakes_processed$holdout <- rbinom(n=nrow(lakes_processed),size=1,prob=0.2)
lakes_training <- lakes_processed %>% filter(holdout==0)
lakes_testing <- lakes_processed %>% filter(holdout==1)
fit_test <- lmer(dissolvedOxygen ~ tp_ug + (1|lakename), data = lakes_training)

print(fit_test)

fit_test_beta_0 <- 8.70408
fit_test_beta_1 <- -0.05471

lakes_testing$do_predicted <- fit_test_beta_0 + 
    fit_test_beta_1*lakes_testing$tp_ug

MAPE_hierarchical <- sqrt(mean((lakes_testing$dissolvedOxygen - lakes_testing$do_predicted)^2, na.rm = TRUE))

print(MAPE_hierarchical)

```

```{r hierarchical plot, fig.cap = "Figure 3", echo=FALSE, message=FALSE}

ggplot(lakes_processed, aes(x = tp_ug, y = dissolvedOxygen, color = lakename)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +  # Add a linear regression line
  labs(x = "Total Phosphorus (µg)", y = "Dissolved Oxygen (mg/L)", color = "Lake Name") +
  scale_x_continuous(breaks = seq(0, 300, by = 50))+
  scale_y_continuous(breaks = seq(0, 20, by = 5))+
  theme_light() +
  ggtitle("Dissolved Oxygen vs Total Phosphorus by Lake") +
  theme(legend.position = "right")

```

```{r hierarchical model residuals, include = FALSE, message=FALSE, warning=FALSE}

# Residual Plot (Residuals vs Fitted)
residuals <- resid(fit)
fitted_values <- fitted(fit)

residual_plot <- data.frame(residuals = residuals, fitted_values = fitted_values)

ggplot(residual_plot, aes(x = fitted_values, y = residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(x = "Fitted Values", y = "Residuals") +
  ggtitle("Residuals vs Fitted")

# QQ Plot (Normal Q-Q plot)
qq_plot <- qqnorm(residuals, main = "Normal Q-Q Plot")

# Random Effects Plot (Dot plot of random effects)
random_effects <- ranef(fit)$lakename

random_effects_plot <- data.frame(lakename = rownames(random_effects), random_effect = random_effects[, 1])

```



## APPENDIX

# Model One Residuals
```{r model one residuals, echo = FALSE, message=FALSE, warning=FALSE}

plot(two_season_fit)

```

# Model Two Residuals
```{r model two residuals, echo=FALSE, message=FALSE, warning=FALSE}

plot(jenn_fit_p)

```

# Model Three Residuals
```{r model three residuals, echo = FALSE, message=FALSE, warning=FALSE}

# Residual Plot (Residuals vs Fitted)
residuals <- resid(fit)
fitted_values <- fitted(fit)

residual_plot <- data.frame(residuals = residuals, fitted_values = fitted_values)

ggplot(residual_plot, aes(x = fitted_values, y = residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed") +
  labs(x = "Fitted Values", y = "Residuals") +
  ggtitle("Residuals vs Fitted")

# QQ Plot (Normal Q-Q plot)
qq_plot <- qqnorm(residuals, main = "Normal Q-Q Plot")

# Random Effects Plot (Dot plot of random effects)
random_effects <- ranef(fit)$lakename

random_effects_plot <- data.frame(lakename = rownames(random_effects), random_effect = random_effects[, 1])

```

```{r exploratory plots, echo=FALSE, message=FALSE, warning=FALSE}

ggplot(lakes_processed)+
  geom_point(aes(y=dissolvedOxygen,x=subsurface_indicator))+
  theme_light()

ggplot(lakes_processed)+
  geom_point(aes(y=dissolvedOxygen,x=season))+
  theme_light()
  
```


```{r tp by month with po4, echo=FALSE, message=FALSE, warning=FALSE}

fit_2 <- lm(formula = tp_ug ~ month + po4, data = lake_1994)
print(fit_2)

ggplot(lake_1994, aes(x=po4, y=tp_ug, color=month))+
  geom_point()+
  geom_abline(intercept = coef(fit_2)[1], slope = coef(fit_2)[5], 
              color = "orchid3")+
  geom_abline(intercept = coef(fit_2)[1] + coef(fit_2)[2], slope = coef(fit_2)[5], 
              color = "cyan4")+
  geom_abline(intercept = coef(fit_2)[1] + coef(fit_2)[3], slope = coef(fit_2)[5], 
              color = "slateblue")+
  geom_abline(intercept = coef(fit_2)[1] + coef(fit_2)[4], slope = coef(fit_2)[5], 
              color = "tomato3")+
  scale_color_manual(values = c("5" = "orchid3", 
                                "6" = "cyan4",
                                "7" = "slateblue",
                                "8" = "tomato3"))+
  scale_x_continuous(breaks = seq(0, 20, by = 5))+
  scale_y_continuous(breaks = seq(0, 100, by = 20))+
  ylab(expression("Total Phosphorus" ~ (µg))) +
  xlab(expression("Phosphate" ~ (µg))) +
  ggtitle("Change in Total Phosphorus in Samples Taken 
in May, June, July, and August")+
  theme_light()+
  theme(legend.position="bottom")

```

```{r tp by lake with po4, echo=FALSE, message=FALSE, warning=FALSE}

fit_4 <- lm(formula = tp_ug ~ lakename + po4, data = lake_1994)
print(fit_4)

ggplot(lake_1994, aes(x=po4, y=tp_ug, color=lakename))+
  geom_point()+
  geom_abline(intercept = coef(fit_4)[1], slope = coef(fit_4)[5], 
              color = "orchid3")+
  geom_abline(intercept = coef(fit_4)[1] + coef(fit_4)[2], slope = coef(fit_4)[5], 
              color = "cyan4")+
  geom_abline(intercept = coef(fit_4)[1] + coef(fit_4)[3], slope = coef(fit_4)[5], 
              color = "slateblue")+
  geom_abline(intercept = coef(fit_4)[1] + coef(fit_4)[4], slope = coef(fit_4)[5], 
              color = "tomato3")+
  scale_color_manual(values = c("East Long Lake" = "orchid3", 
                                "Paul Lake" = "cyan4",
                                "Peter Lake" = "slateblue",
                                "West Long Lake" = "tomato3"))+
  scale_x_continuous(breaks = seq(0, 20, by = 5))+
  scale_y_continuous(breaks = seq(0, 100, by = 20))+
  ylab(expression("Total Phosphorus" ~ (µg))) +
  xlab(expression("Phosphate" ~ (µg))) +
  ggtitle("Change in Total Phosphorus in Samples Taken 
at East Long Lake, Paul Lake, Peter Lake, and West Long Lake")+
  theme_light()+
  theme(legend.position="bottom")

```

```{r exploratory for appendix looking at nitrogen and season v DO, echo=FALSE, message=FALSE, warning=FALSE}

two_season_nitrogen <- lm(dissolvedOxygen ~ summer_indicator + tn_ug + summer_indicator*tn_ug,
                     data= two_season_clean)

 ggplot(two_season_clean, aes(x=tn_ug, y=dissolvedOxygen, color=season))+
  geom_point()+
  geom_abline(intercept = coef(two_season_nitrogen)[1],
              slope = coef(two_season_nitrogen)[3],
              color = "thistle3", size = 1)+
  geom_abline(intercept = coef(two_season_nitrogen)[1] + coef(two_season_nitrogen)[2],
              slope = coef(two_season_nitrogen)[3] + coef(two_season_nitrogen)[4],
              color = "darkgoldenrod1", size = 1)+
  scale_color_manual(values = c("spring" = "thistle3", "summer" = "darkgoldenrod1"))+
  # scale_x_continuous(breaks = seq(0, 300, by = 50))+
  # scale_y_continuous(breaks = seq(0, 15, by = 5))+
  xlab(expression("Total Nitrogen" ~ (µg)))+
  ylab("dissolved oxygen (mg/L)")+
  theme_light()+
  theme(legend.position="right")+
  labs(color = "Season")

```


```{r depth model with nitrogen, echo=FALSE, message=FALSE, warning=FALSE}

jenn_fit_n <- lm(formula = dissolvedOxygen ~ subsurface_indicator + tn_ug + subsurface_tn_ug, 
                 data = jenn)

print(jenn_fit_n)

#plot total nitrogen versus dissolved oxygen
ggplot(jenn, aes(x=tn_ug, y=dissolvedOxygen, color=subsurface))+
  geom_point()+
  geom_abline(intercept = coef(jenn_fit_n)[1], 
              slope = coef(jenn_fit_n)[3], 
              color = "steelblue1", size = 1)+
  geom_abline(intercept = coef(jenn_fit_n)[1] + coef(jenn_fit_n)[2], 
              slope = coef(jenn_fit_n)[3] + coef(jenn_fit_n)[4], 
              color = "steelblue4", size = 1)+
  scale_color_manual(values = c("surface" = "steelblue1", "subsurface" = "steelblue4"))+
  scale_x_continuous(breaks = seq(0, 3500, by = 500))+
  scale_y_continuous(breaks = seq(0, 15, by = 5))+
  xlab("total nitrogen (micrograms)")+
  ylab("dissolved oxygen (units?)")+
  theme_light()+
  theme(legend.position="right")+
  labs(color = "depth")

```


```{r Heirarchical at surface, echo=FALSE, message=FALSE, warning=FALSE}

lakes_processed_surface <- lakes_processed %>% 
  filter(subsurface_indicator==0)
# Fit hierarchical linear mixed-effects model
fit <- lmer(dissolvedOxygen ~ tp_ug + (1|lakename), data = lakes_processed_surface)

# Summary of the model
summary(fit)

# Print the model
print(fit)

# Extract the random effects
random_effects <- fit@u

# Plotting the relationship between total phosphorus (tp_ug) and dissolved oxygen (dissolvedOxygen) by lakename
ggplot(lakes_processed_surface, aes(x = tp_ug, y = dissolvedOxygen, color = lakename)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +  # Add a linear regression line
  labs(x = "Total Phosphorus (µg)", y = "Dissolved Oxygen (mg/L)", color = "Lake Name") +
  theme_minimal() +
  ggtitle("Dissolved Oxygen vs Total Phosphorus by Lake at Surface") +
  theme(legend.position = "bottom")

```

```{r Heirarchical summer, echo=FALSE, message=FALSE, warning=FALSE}

lakes_processed_summer <- lakes_processed %>% 
  filter(summer_indicator==1)
# Fit hierarchical linear mixed-effects model
fit <- lmer(dissolvedOxygen ~ tp_ug + (1|lakename), data = lakes_processed_summer)

# Summary of the model
summary(fit)

# Print the model
print(fit)

# Extract the random effects
random_effects <- fit@u

# Plotting the relationship between total phosphorus (tp_ug) and dissolved oxygen (dissolvedOxygen) by lakename
ggplot(lakes_processed_summer, aes(x = tp_ug, y = dissolvedOxygen, color = lakename)) +
  geom_point() +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE) +  # Add a linear regression line
  labs(x = "Total Phosphorus (µg)", y = "Dissolved Oxygen (mg/L)", color = "Lake Name") +
  theme_minimal() +
  ggtitle("Dissolved Oxygen vs Total Phosphorus by Lake in Summer") +
  theme(legend.position = "bottom")

```

```{r new wrangling with all years and DO less than 5, echo=FALSE, message=FALSE, warning=FALSE}

lakes_all_years <- lakes_raw %>%
  select(lakename, sampledate, depth, tn_ug, tp_ug, nh34, no23, po4) %>%
  na.omit() %>%
  filter(lakename %in% c("Paul Lake", "West Long Lake", "Peter Lake", "East Long Lake")) %>%
  mutate(year = factor(year(sampledate)),
         month = factor(month(sampledate)),
         subsurface = factor(ifelse(depth > 1, "subsurface", "surface")),
         season = factor(ifelse(month == 5, "spring", ifelse(month == 8, "summer", NA)))) %>%
  filter(month %in% c(5,6,7,8)) %>%
  mutate(depth = round(depth * 2) / 2)

lakes_all_years$subsurface_indicator <- 
  ifelse(lakes_all_years$subsurface == "subsurface", 1, 0)

lakes_all_years$summer_indicator <- 
  ifelse(lakes_all_years$season == "summer", 1, 0)

lakes_all_years <- left_join(lakes_all_years, 
                             select(do_raw, lakename, sampledate, depth, dissolvedOxygen), 
                             by = c("lakename", "sampledate", "depth"))

lakes_all_years <- lakes_all_years %>%
  filter(dissolvedOxygen <= 5)

```


```{r log transformation, echo=FALSE, message=FALSE, warning=FALSE}

two_season_fit_log <- lm(dissolvedOxygen ~ summer_indicator + log(tp_ug) +
                           summer_indicator*tp_ug, data = two_season_clean)

ggplot(two_season_clean, aes(x=log(tp_ug), y=dissolvedOxygen, color=season))+
  geom_point()+
  geom_abline(intercept = coef(two_season_fit_log)[1],
              slope = coef(two_season_fit_log)[3],
              color = "thistle3", size = 1)+
  geom_abline(intercept = coef(two_season_fit_log)[1] + coef(two_season_fit_log)[2],
              slope = coef(two_season_fit_log)[3] + coef(two_season_fit_log)[4],
              color = "darkgoldenrod1", size = 1)+
  scale_color_manual(values = c("spring" = "thistle3", "summer" = "darkgoldenrod1"))+
  #scale_x_continuous(breaks = seq(0, 300, by = 50))+
  #scale_y_continuous(breaks = seq(0, 15, by = 5))+
  xlab(expression("Log Transformed Total Phosphorus" ~ (µg)))+
  ylab("dissolved oxygen (mg/L)")+
  theme_light()+
  theme(legend.position="right")+
  labs(color = "Season")

```


